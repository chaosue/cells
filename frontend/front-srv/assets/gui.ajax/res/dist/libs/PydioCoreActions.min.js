(()=>{var e={3696:()=>{},8566:e=>{"use strict";e.exports=require("create-react-class")},2610:e=>{"use strict";e.exports=require("pydio/http/resources-manager")},6689:e=>{"use strict";e.exports=require("react")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";r.r(n),r.d(n,{BookmarkButton:()=>B,Callbacks:()=>$,MaskWsButton:()=>J,Navigation:()=>Q,PasswordDialog:()=>_,SplashDialog:()=>P});var e=r(3696),t=r.n(e),o=window,i=o.pydio,a=i.MessageHash;const s=require("pydio");var c=r.n(s);const u=require("pydio/http/api");var l=r.n(u);const f=require("cells-sdk");function p(e,t){var r=c().getInstance(),n="true"===e.getMetadata().get("bookmark"),o=e.getMetadata().get("uuid"),i=r.user.id,a=new f.UserMetaServiceApi(l().getRestClient()),s=new f.IdmUpdateUserMetaRequest;if(n){var u=new f.IdmSearchUserMetaRequest;return u.NodeUuids=[o],u.Namespace="bookmark",a.searchUserMeta(u).then((function(e){e.Metadatas&&e.Metadatas.length&&(s.Operation=f.UpdateUserMetaRequestUserMetaOp.constructFromObject("DELETE"),s.MetaDatas=e.Metadatas,a.updateUserMeta(s).then((function(){r.notify("reload-bookmarks")})))}))}s.Operation=f.UpdateUserMetaRequestUserMetaOp.constructFromObject("PUT");var p=new f.IdmUserMeta;return p.NodeUuid=o,p.Namespace="bookmark",p.JsonValue='"true"',p.Policies=[f.ServiceResourcePolicy.constructFromObject({Resource:o,Action:"OWNER",Subject:"user:"+i,Effect:"allow"}),f.ServiceResourcePolicy.constructFromObject({Resource:o,Action:"READ",Subject:"user:"+i,Effect:"allow"}),f.ServiceResourcePolicy.constructFromObject({Resource:o,Action:"WRITE",Subject:"user:"+i,Effect:"allow"})],s.MetaDatas=[p],a.updateUserMeta(s).then((function(){r.notify("reload-bookmarks")}))}var d=r(6689),y=r.n(d),m=r(8566),g=r.n(m);const h=require("material-ui"),b=require("react-markdown");var v=r.n(b),O=c().requireLib("boot"),w=O.ActionDialogMixin,S=O.SubmitButtonProviderMixin,k=O.Loader;const P=g()({displayName:"SplashDialog",mixins:[w,S],getDefaultProps:function(){return{dialogTitle:"",dialogSize:"lg",dialogIsModal:!1,dialogPadding:!1,dialogScrollBody:!0}},submit:function(){this.dismiss()},getInitialState:function(){return{aboutContent:null}},componentDidMount:function(){var e=this;window.fetch("plug/gui.ajax/credits.md",{method:"GET",credentials:"same-origin"}).then((function(t){t.text().then((function(t){e.setState({aboutContent:t})}))}))},render:function(){var e;return e=this.state.aboutContent?y().createElement(v(),null,this.state.aboutContent):y().createElement(k,{style:{minHeight:200}}),y().createElement("div",{style:{height:"100%",width:"100%"}},y().createElement(h.Card,{style:{borderRadius:0}},y().createElement(h.CardActions,{style:{display:"flex",alignItems:"center"}},y().createElement(h.IconButton,{style:{width:28,height:28,padding:0,margin:0,marginRight:0},iconStyle:{color:"#FF786A",fontSize:"28px"},iconClassName:"icomoon-cells"}),y().createElement(h.CardTitle,{title:pydio.Parameters.get("backend").PackageLabel,style:{padding:0}})),y().createElement(h.Divider,null),y().createElement(h.Divider,null),y().createElement(h.CardText,{className:"credits-md"},e),y().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:"\n.credits-md h4 {\n    padding-top: 0;\n}\n\n.credits-md h5 {\n    font-weight: 500;\n}\n\n.credits-md ul {\n    padding-left: 20px;\n    padding-bottom: 20px;\n}\n\n.credits-md li {\n    list-style-type: square;\n    line-height: 1.6em;\n}\n\n.credits-md a {\n    color: #607D8B;\n    font-weight: 500;\n}\n"}})))}});var j=r(6689),M=r(8566),C=r(2610).requireLib("boot"),E=C.ActionDialogMixin,x=C.AsyncComponent;const _=M({displayName:"PasswordDialog",mixins:[E],getInitialState:function(){return{passValid:!1}},getDefaultProps:function(){return{dialogTitle:c().getMessages()[194],dialogIsModal:!0,dialogSize:"sm"}},getButtons:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(this._updater=t);var r=[];return this.props.locked||r.push(j.createElement(h.FlatButton,{label:this.props.pydio.MessageHash[54],onClick:function(){return e.dismiss()}})),r.push(j.createElement(h.FlatButton,{label:this.props.pydio.MessageHash[48],onClick:this.submit.bind(this),disabled:!this.state.passValid})),r},submit:function(){if(!this.state.passValid)return!1;this.refs.passwordForm.instance.post(function(e){e&&this.dismiss()}.bind(this))},passValidStatusChange:function(e){var t=this;this.setState({passValid:e},(function(){t._updater(t.getButtons())}))},render:function(){return j.createElement(x,{namespace:"UserAccount",componentName:"PasswordForm",pydio:this.props.pydio,ref:"passwordForm",onValidStatusChange:this.passValidStatusChange})}});function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function D(){return D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D.apply(this,arguments)}function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){N(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function q(e,t){return q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},q(e,t)}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}const B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t,r,i=T(n);if(o){var a=T(this).constructor;e=Reflect.construct(i,arguments,a)}else e=i.apply(this,arguments);return t=this,!(r=e)||"object"!==R(r)&&"function"!=typeof r?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):r});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state=t.valueFromNodes(e.nodes),t}return t=a,r=[{key:"valueFromNodes",value:function(){var e,t=void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(r){var n="true"===r.getMetadata().get("bookmark");void 0!==t&&n!==t&&(e=!0),t=n})),{value:t,mixed:e}}},{key:"updateValue",value:function(e){var t=this,r=this.props.nodes;this.setState({saving:!0});var n=[];r.forEach((function(t){var r="true"===t.getMetadata().get("bookmark");if(e!==r){n.push(p(t));var o=t.getMetadata().get("overlay_class")||"";if(e){t.getMetadata().set("bookmark","true");var i=o.replace("mdi mdi-star","").split(",");i.push("mdi mdi-star"),t.getMetadata().set("overlay_class",i.join(","))}else t.getMetadata().delete("bookmark"),t.getMetadata().set("overlay_class",o.replace("mdi mdi-star",""));t.notify("node_replaced")}})),Promise.all(n).then((function(){window.setTimeout((function(){t.setState({saving:!1})}),250),t.setState(t.valueFromNodes(r))})).catch((function(){t.setState({saving:!1})}))}},{key:"render",value:function(){var e,t,r,n,o=this,i=this.props.styles,a=this.state,s=a.value,u=a.mixed,l=a.saving,f=c().getInstance().MessageHash;return u?(e="star-half",t=!0,r=f["bookmark.button.tip.mixed"]):s?(e="star",t=!1,r=f["bookmark.button.tip.remove"]):(e="star-outline",t=!0,r=f["bookmark.button.tip.add"]),l&&(e="star-circle",r=f["bookmark.button.tip.saving"],n=!0),y().createElement(h.IconButton,D({disabled:n,iconClassName:"mdi mdi-"+e,tooltip:r,onClick:function(){return o.updateValue(t)}},i,{style:U(U({},{width:40,height:40,padding:8}),i.style),iconStyle:U(U({},{color:"var(--md-sys-color-primary)"}),i.iconStyle)}))}}],r&&A(t.prototype,r),a}(y().Component);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){W(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function z(e,t){return z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},z(e,t)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}var J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t,r,i=K(n);if(o){var a=K(this).constructor;e=Reflect.construct(i,arguments,a)}else e=i.apply(this,arguments);return t=this,!(r=e)||"object"!==F(r)&&"function"!=typeof r?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t):r});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){var e=this.props,t=e.pydio,r=e.workspaceId,n=e.iconStyle,o=e.style;if(!t.user)return null;var i=t.user.getGUIPreference("MaskedWorkspaces")||[],a=i.indexOf&&i.indexOf(r)>-1;return y().createElement(h.IconButton,{iconClassName:"mdi mdi-playlist-"+(a?"check":"remove"),style:L(L({},{width:40,height:40,padding:8}),o),iconStyle:L(L({},{color:"var(--md-sys-color-primary)"}),n),tooltip:t.MessageHash["ajax_gui.wslist.action."+(a?"unmask":"mask")],onClick:function(){var e,n=function(e){if(Array.isArray(e))return H(e)}(e=i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return H(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?H(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();a?n=i.filter((function(e){return e!==r})):n.push(r),t.user.setGUIPreference("MaskedWorkspaces",n,!0)}})}}])&&G(t.prototype,r),a}(y().Component),$={switchLanguage:t(),changePass:function(){i.UI.openComponentInModal("PydioCoreActions","PasswordDialog",{locked:i.user&&"pass_change"===i.user.lock})},toggleBookmark:function(){var e=i.getContextHolder();!e.isEmpty()&&e.isUnique()&&p(e.getUniqueNode())},toggleBookmarkNode:p,activateDesktopNotifications:function(){o.Notification?(alert(a["notification_center.12"]),o.Notification.requestPermission((function(e){["default","granted","denied"].indexOf(e)}))):o.alert(a["notification_center.13"])}},Q={splash:function(){i.UI.openComponentInModal("PydioCoreActions","SplashDialog")},up:function(){i.fireContextUp()},refresh:function(){i.getContextHolder().getContextNode()===i.getContextHolder().getSearchNode()?i.getContextHolder().getSearchNode().notify("reload_search"):i.fireContextRefresh()},externalSelection:function(){var e=i.getUserSelection();if(e.isUnique()&&!e.hasDir()){var t=e.getUniqueFileName(),r=i.getController().selectorData;if("ckeditor"==r.get("type")){var n=r.get("data");if(n.CKEditorFuncNum){var a=t;n.relative_path&&(a=n.relative_path+t),o.opener.CKEDITOR.tools.callFunction(n.CKEditorFuncNum,a),o.close()}}}},openGoPro:function(){o.open("https://pydio.com/en/go-pro?referrer=settings")},switchToSettings:function(){i.repositoryId&&"settings"===i.repositoryId||i.triggerRepositoryChange("settings")},switchToHomepage:function(){i.repositoryId&&"homepage"===i.repositoryId||i.triggerRepositoryChange("homepage")}}})(),window.PydioCoreActions=n})();